function loadProducts(sheetName) {
    const sheet = workbook.Sheets[sheetName];
    const rows = XLSX.utils.sheet_to_json(sheet, { header: 1 });
    const products = {}; // 用于存储分组后的产品

    // 分组产品
    rows.slice(1).forEach(row => {
        const model = row[1] || '';
        const chineseDescription = row[3] || '';
        const wholesalePriceRMB = row[4] || '';
        const wholesalePriceUSD = row[5] || '';
        const englishDescription = row[6] || '';
        const imageSrc = row[0] ? `picture/${sheetName}/${row[0]}.png` : 'default-image.png';

        if (!products[englishDescription]) {
            products[englishDescription] = {
                modelOptions: [],
                imageSrc: imageSrc,
                chineseDescription: chineseDescription,
                englishDescription: englishDescription,
                priceRMB: wholesalePriceRMB,
                priceUSD: wholesalePriceUSD
            };
        }

        products[englishDescription].modelOptions.push({
            model: model,
            priceRMB: wholesalePriceRMB,
            priceUSD: wholesalePriceUSD,
            chineseDescription: chineseDescription
        });
    });

    // 清空现有卡片
    productListDiv.innerHTML = '';

    // 创建产品卡片
    Object.values(products).forEach(product => {
        const card = document.createElement('div');
        card.className = 'col';
        card.innerHTML = `
            <div class="card product-card shadow-sm">
                <img src="${product.imageSrc}" alt="Product Image" class="card-img-top" onerror="this.onerror=null;this.src='default-image.png';">
                <div class="card-body">
                    <h5 class="card-title">${product.englishDescription}</h5>
                    <p class="card-text">${product.chineseDescription}</p>
                    <select class="form-select" onchange="updatePriceAndDescription(this, '${product.englishDescription}')">
                        <option value="">选择型号</option>
                        ${product.modelOptions.map(option => `
                            <option value="${option.model}">${option.model}</option>
                        `).join('')}
                    </select>
                    <p id="productPrice-${product.englishDescription}" class="card-text mt-3"><strong>Price:</strong> ¥${product.priceRMB} / $${product.priceUSD}</p>
                    <p id="productDescription-${product.englishDescription}" class="card-text">${product.chineseDescription}</p>
                </div>
            </div>
        `;
        productListDiv.appendChild(card);

        // 确保 `select` 元素加载完成后绑定事件
        const modelSelect = card.querySelector('select');
        if (modelSelect) {
            modelSelect.addEventListener('change', (event) => {
                updatePriceAndDescription(event.target, product.englishDescription);
            });
        }
    });
}
