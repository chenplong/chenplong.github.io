<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="广州卡志贸易有限公司 - 提供最新的电子产品">
    <title>广州卡志贸易有限公司商城</title>
    <!-- 引入Bootstrap框架 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #2f2f2f;
            color: white;
            margin: 0;
            padding: 0;
        }
        header {
            background-color: #1a1a1a;
            padding: 20px;
            text-align: center;
        }
        header img {
            width: 120px;
            height: auto;
        }
        section {
            padding: 40px;
        }
        h1 {
            font-size: 36px;
            margin-bottom: 20px;
        }
        .contact-info {
            margin-top: 30px;
            text-align: center;
        }
        .contact-info img {
            width: 150px;
            margin: 10px;
        }
        table {
            width: 100%;
            margin-top: 30px;
            border-collapse: collapse;
            background-color: #333;
        }
        table th, table td {
            padding: 12px;
            text-align: center;
            border: 1px solid #444;
        }
        table th {
            background-color: #1e1e1e;
        }
        table td {
            background-color: #222;
        }
        table tr:nth-child(even) {
            background-color: #2a2a2a;
        }
        footer {
            background-color: #1a1a1a;
            padding: 10px;
            text-align: center;
            font-size: 14px;
            color: #ccc;
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <!-- 引入Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>

<header>
    <img src="company-logo.png" alt="Company Logo">
    <h1>欢迎来到 广州卡志贸易有限公司商城</h1>
</header>

<section>
    <div class="contact-info">
        <h2>联系我们</h2>
        <p>负责人: Jason</p>
        <p>微信: <img src="wechat-qr.png" alt="WeChat QR Code"></p>
        <p>Whatsapp: +8615999911625</p>
        <p>Factory: OEM/ODM</p>
    </div>

    <!-- 产品选择按钮 -->
    <div id="categoryButtons" class="d-flex justify-content-center mb-4">
        <!-- 动态生成的按钮 -->
    </div>

    <!-- 产品列表 -->
    <div id="productList">
        <!-- 动态生成的表格 -->
    </div>
</section>

<footer>
    <p>© 2025 广州卡志贸易有限公司 版权所有</p>
</footer>

<script>
    fetch('test.xlsx')
        .then(response => response.arrayBuffer())
        .then(data => {
            const workbook = XLSX.read(data, { type: 'array' });
            const sheetNames = workbook.SheetNames;

            const categoryButtonsDiv = document.getElementById('categoryButtons');
            const productListDiv = document.getElementById('productList');
            productListDiv.innerHTML = ''; // 清空现有数据
            categoryButtonsDiv.innerHTML = ''; // 清空按钮

            // 创建按钮
            sheetNames.forEach(sheetName => {
                const button = document.createElement('button');
                button.className = 'btn btn-primary m-2';
                button.textContent = sheetName;
                button.onclick = () => loadProducts(sheetName);
                categoryButtonsDiv.appendChild(button);
            });

            // 默认显示第一个sheet的产品
            if (sheetNames.length > 0) {
                loadProducts(sheetNames[0]);
            }

            // 加载产品信息
            function loadProducts(sheetName) {
                const sheet = workbook.Sheets[sheetName];
                const rows = XLSX.utils.sheet_to_json(sheet, { header: 1 });
                const table = document.createElement('table');
                table.className = 'table table-dark table-bordered';

                // 创建表头
                const thead = document.createElement('thead');
                const headerRow = document.createElement('tr');
                ['Product Image', 'Model', 'Specification', 'Chinese Description', 'Wholesale Price (RMB)', 'Wholesale Price (USD)', 'English Description'].forEach(text => {
                    const th = document.createElement('th');
                    th.textContent = text;
                    headerRow.appendChild(th);
                });
                thead.appendChild(headerRow);
                table.appendChild(thead);

                // 创建表格内容
                const tbody = document.createElement('tbody');
                rows.slice(1).forEach(row => {
                    const newRow = document.createElement('tr');
                    const cells = [
                        { content: row[0] ? `<img src="picture/${sheetName}/${row[0]}.png" alt="Product Image" style="width: 50px;" onerror="this.onerror=null;this.src='default-image.png';">` : '' },
                        { content: row[1] || '' },
                        { content: row[2] || '' },
                        { content: row[3] || '' },
                        { content: row[4] || '' },
                        { content: row[5] || '' },
                        { content: row[6] || '' }
                    ];

                    cells.forEach(cellData => {
                        const cell = document.createElement('td');
                        if (typeof cellData.content === 'string' && cellData.content.startsWith('<img')) {
                            cell.innerHTML = cellData.content;
                        } else {
                            cell.textContent = cellData.content;
                        }
                        newRow.appendChild(cell);
                    });

                    tbody.appendChild(newRow);
                });

                table.appendChild(tbody);
                productListDiv.innerHTML = ''; // 清空现有表格
                productListDiv.appendChild(table);
            }
        })
        .catch(error => {
            console.error('读取 Excel 文件时出错:', error);
        });
</script>

</body>
</html>
