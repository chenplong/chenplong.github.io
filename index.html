<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="广州卡志贸易有限公司 - 提供最新的电子产品">
    <title>广州卡志贸易有限公司商城</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #2f2f2f;
            color: white;
            margin: 0;
            padding: 0;
        }
        header {
            background-color: #1a1a1a;
            padding: 20px;
            text-align: center;
        }
        header img {
            width: 120px;
            height: auto;
        }
        section {
            padding: 40px;
        }
        h1 {
            font-size: 36px;
            margin-bottom: 20px;
        }
        .contact-info {
            margin-top: 30px;
            text-align: center;
        }
        .contact-info img {
            width: 150px;
            margin: 10px;
        }
        table {
            width: 100%;
            margin-top: 30px;
            border-collapse: collapse;
            background-color: #333;
        }
        table th, table td {
            padding: 12px;
            text-align: center;
            border: 1px solid #444;
        }
        table th {
            background-color: #1e1e1e;
        }
        table td {
            background-color: #222;
        }
        table tr:nth-child(even) {
            background-color: #2a2a2a;
        }
        footer {
            background-color: #1a1a1a;
            padding: 10px;
            text-align: center;
            font-size: 14px;
            color: #ccc;
        }
    </style>
    <!-- 引入SheetJS库 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
</head>
<body>

<header>
    <img src="company-logo.png" alt="Company Logo">
    <h1>欢迎来到 广州卡志贸易有限公司商城</h1>
</header>

<section>
    <div class="contact-info">
        <h2>联系我们</h2>
        <p>负责人: Jason</p>
        <p>微信: <img src="wechat-qr.png" alt="WeChat QR Code"></p>
        <p>Whatsapp: +8615999911625</p>
        <p>Factory: OEM/ODM</p>
    </div>

    <h2>产品目录</h2>
    <table id="productsTable">
        <thead>
            <tr>
                <th>Product Image</th>
                <th>Model</th>
                <th>Specification</th>
                <th>Chinese Description</th>
                <th>Wholesale Price (RMB)</th>
                <th>Wholesale Price (USD)</th>
                <th>English Description</th>
            </tr>
        </thead>
        <tbody>
            <!-- Product rows will be inserted here -->
        </tbody>
    </table>
</section>

<footer>
    <p>© 2025 广州卡志贸易有限公司 版权所有</p>
</footer>

<script>
    // 读取 test.xlsx 文件
    fetch('test.xlsx')
        .then(response => response.arrayBuffer())
        .then(data => {
            const workbook = XLSX.read(data, { type: 'array' });
            const tableBody = document.getElementById('productsTable').getElementsByTagName('tbody')[0];
            tableBody.innerHTML = ''; // 清空现有数据

            // 遍历 Excel 文件的所有 sheet 表
            workbook.SheetNames.forEach(sheetName => {
                const sheet = workbook.Sheets[sheetName];
                const rows = XLSX.utils.sheet_to_json(sheet, { header: 1 });

                // 跳过第一行（标题行），然后处理每个产品
                rows.slice(1).forEach(row => {
                    const newRow = tableBody.insertRow();
                    
                    // 根据列的顺序读取并赋值
                    const productImage = row[0] ? `<img src="picture/${sheetName}/${row[0]}.png" alt="Product Image" style="width: 50px;" onerror="this.onerror=null;this.src='default-image.png';">` : ''; 
                    const model = row[1] || '';        
                    const specification = row[2] || ''; 
                    const chineseDescription = row[3] || ''; 
                    const wholesalePriceRMB = row[4] || ''; 
                    const wholesalePriceUSD = row[5] || ''; 
                    const englishDescription = row[6] || ''; 

                    // 插入每个产品的表格数据
                    const cells = [
                        { content: productImage },  // 插入图片
                        { content: model },         // 插入型号
                        { content: specification }, // 插入规格
                        { content: chineseDescription }, // 插入中文描述
                        { content: wholesalePriceRMB }, // 插入批发价格（人民币）
                        { content: wholesalePriceUSD }, // 插入批发价格（美元）
                        { content: englishDescription } // 插入英文描述
                    ];

                    // 添加每个单元格
                    cells.forEach(cellData => {
                        const cell = newRow.insertCell();
                        if (cellData.content.includes('<img')) {
                            // 如果是图片HTML内容
                            cell.innerHTML = cellData.content;
                        } else {
                            // 否则是文本内容
                            cell.innerText = cellData.content;
                        }
                    });
                });
            });
        })
        .catch(error => {
            console.error('读取 Excel 文件时出错:', error);
        });
</script>

</body>
</html>
